% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/server.R
\name{survey}
\alias{survey}
\title{Deploy a Survey Shiny Application}
\usage{
survey(
  json = NULL,
  list = NULL,
  show_response = FALSE,
  theme = "defaultV2",
  theme_color = "#003594",
  shiny_config = list(host = "0.0.0.0", port = 3838),
  db_config = list(host = Sys.getenv("HOST"), port = as.numeric(Sys.getenv("PORT")),
    db_name = Sys.getenv("DB_NAME"), user = Sys.getenv("USER"), password =
    Sys.getenv("PASSWORD"), write_table = Sys.getenv("WRITE_TABLE"), log_table =
    Sys.getenv("LOG_TABLE")),
  db_update = NULL,
  db_logic = NULL,
  cookie_expiration_days = 0,
  custom_css = NULL,
  echo = TRUE
)
}
\arguments{
\item{json}{String. JSON survey definition or object.}

\item{list}{List. Survey structure to convert to JSON.}

\item{show_response}{Logical. Display responses in a data.table after submission.
Default: \code{FALSE}.}

\item{theme}{String. SurveyJS theme, either "defaultV2" or "modern".
Default: "defaultV2".}

\item{theme_color}{String. Hex color code for primary theme customization.}

\item{shiny_config}{List. Optional Shiny configuration parameters.}

\item{db_config}{List. Database connection parameters. If not specified,
values are read from environment variables:
\itemize{
\item \code{host}: Database host (env: HOST)
\item \code{port}: Database port (env: PORT)
\item \code{db_name}: Database name (env: DB_NAME)
\item \code{user}: Database username (env: USER)
\item \code{password}: Database password (env: PASSWORD)
\item \code{write_table}: Survey data table name (env: WRITE_TABLE)
\item \code{log_table}: Log messages table name (env: LOG_TABLE)
}}

\item{db_update}{List. Configuration for updating existing records instead of inserting new ones.
Each element should be a list containing:
\itemize{
\item \code{from}: Source survey name to update from
\item \code{to}: Target survey name to update to
\item \code{by}: Named character vector specifying the join columns (e.g., c("field_in_from" = "field_in_to"))
}}

\item{db_logic}{List. Configuration for database logic. Supports three types:
\subsection{Choice Configuration}{
Populates dropdown or radio button choices from database tables:
* \code{config_type}: Set to "choice"
* \code{table_name}: Database table to populate choices from
* \code{config_col}: Column containing choice text
* \code{display_col}: Optional column for display text

\if{html}{\out{<div class="sourceCode">}}\preformatted{For dependent fields:
* `parent_table_name`: Parent table for dependency chain
* `parent_id_col`: Column linking to parent table
}\if{html}{\out{</div>}}

}
\subsection{Parameter Configuration}{
Handles URL query parameters and hidden fields:
* \code{config_type}: Set to "param"
* \code{table_name}: Database table with valid parameters
* \code{config_col}: Column matching URL parameter name
* \code{display_col}: Optional column for display text
}
\subsection{Unique Value Configuration}{
Validates unique entries against existing database records:
* \code{config_type}: Set to "unique"
* \code{config_col}: Column to check for uniqueness
* \code{result}: Action on duplicate ("warn" or "stop")
* \code{result_field}: Survey field for warning message (should be hidden)
}}

\item{cookie_expiration_days}{Numeric. Number of days to retain survey cookies (experimental).
Default: 0.}

\item{custom_css}{String. Custom CSS rules to append to the theme.}

\item{echo}{Logical. Display console log messages. Default: \code{TRUE}.}
}
\value{
A Shiny application object
}
\description{
Creates and deploys a Shiny application for a survey using SurveyJS
(\url{https://surveyjs.io}) with MySQL and DBI database integration. The application handles
survey data collection, database logic, and asynchronous logging through a future plan.
}
\examples{
\dontrun{
# Choice configuration example
db_logic <- list(
  list(
    config_type = "choice",
    table_name = "packages",
    config_col = "name"
  )
)

# Parameter configuration example
db_logic <- list(
  list(
    config_type = "param",
    table_name = "sources",
    config_col = "source",
    display_col = "display_text"
  )
)

# Unique value configuration example
db_logic <- list(
  list(
    config_type = "unique",
    config_col = "title",
    result = "warn",
    result_field = "warning_message"
  )
)
}

}
